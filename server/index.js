// =========================================================================== //
// =============================== IMPORTS =================================== //
// =========================================================================== //


// ===== Main imports ============================================================ //

const express = require('express');
const app = express();


// ===== CORS ============================================================ //

const cors = require('cors');


// ===== dotEnv ============================================================ //

require("dotenv").config()


// ===== MongoDB ============================================================ //

const mongoose = require('mongoose');


// ===== MongoDB ============================================================ //

const cookieParser = require('cookie-parser')


// ===== Routes ============================================================ //

const userRoutes = require("./routes/userRoutes")
const jobsRoutes = require("./routes/jobsRoutes");


// =========================================================================== //
// ========================= MIDDLEWARES & CONFIG ============================ //
// =========================================================================== //


// ===== CORS ============================================================ //

app.use(cors())


// ===== Express ============================================================ //

app.use(express.json())

app.use(express.urlencoded({
    extended: false
}))


// ===== MongoDB ============================================================ //

mongoose.set("strictQuery", false);

mongoose.connect(process.env.MONGO_URI_AND_CONNECTION_KEY, {
    useNewUrlParser: true,
    useUnifiedTopology: true
})


// ===== MongoDB ============================================================ //

app.use(cookieParser())


// =========================================================================== //
// ================================= CODE ==================================== //
// =========================================================================== //


// ===== Routes ============================================================ //

app.use('/users', userRoutes)
app.use('/jobs', jobsRoutes)


// =========================================================================== //
// ================================ PORTS ==================================== //
// =========================================================================== //

const port = process.env.PORT

app.listen(port, () => {
    console.log(`server listening on ${port}`);
});